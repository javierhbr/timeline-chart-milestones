import{r as l,j as e,y as X,a2 as $,D as I,x as G,Y as _,E,ak as K,X as U,p as T,B as R}from"./index-DeksGDDi.js";import{D as V,a as Y,b as J,c as Q,d as W,L as w,e as Z}from"./label-BttNplgj.js";import{I as ee}from"./input-BoUPo5Dg.js";import{u as se,C as te,S as ne,a as ae,b as re,c as oe,d as ce}from"./select-VsNWQHqQ.js";import{C as ie}from"./circle-check-big-DOqoCIid.js";import{C as le}from"./circle-alert-V_y01eYo.js";import{X as de}from"./x-Ds1ghz-F.js";import"./index-Dhp8sDxk.js";var v="Checkbox",[ue,ye]=X(v),[me,D]=ue(v);function he(t){const{__scopeCheckbox:o,checked:d,children:n,defaultChecked:c,disabled:s,form:r,name:u,onCheckedChange:i,required:b,value:C="on",internal_do_not_use_render:p}=t,[f,a]=G({prop:d,defaultProp:c??!1,onChange:i,caller:v}),[m,k]=l.useState(null),[j,h]=l.useState(null),x=l.useRef(!1),N=m?!!r||!!m.closest("form"):!0,y={checked:f,disabled:s,setChecked:a,control:m,setControl:k,name:u,form:r,value:C,hasConsumerStoppedPropagationRef:x,required:b,defaultChecked:g(c)?!1:c,isFormControl:N,bubbleInput:j,setBubbleInput:h};return e.jsx(me,{scope:o,...y,children:pe(p)?p(y):n})}var P="CheckboxTrigger",B=l.forwardRef(({__scopeCheckbox:t,onKeyDown:o,onClick:d,...n},c)=>{const{control:s,value:r,disabled:u,checked:i,required:b,setControl:C,setChecked:p,hasConsumerStoppedPropagationRef:f,isFormControl:a,bubbleInput:m}=D(P,t),k=_(c,C),j=l.useRef(i);return l.useEffect(()=>{const h=s?.form;if(h){const x=()=>p(j.current);return h.addEventListener("reset",x),()=>h.removeEventListener("reset",x)}},[s,p]),e.jsx(I.button,{type:"button",role:"checkbox","aria-checked":g(i)?"mixed":i,"aria-required":b,"data-state":q(i),"data-disabled":u?"":void 0,disabled:u,value:r,...n,ref:k,onKeyDown:E(o,h=>{h.key==="Enter"&&h.preventDefault()}),onClick:E(d,h=>{p(x=>g(x)?!0:!x),m&&a&&(f.current=h.isPropagationStopped(),f.current||h.stopPropagation())})})});B.displayName=P;var M=l.forwardRef((t,o)=>{const{__scopeCheckbox:d,name:n,checked:c,defaultChecked:s,required:r,disabled:u,value:i,onCheckedChange:b,form:C,...p}=t;return e.jsx(he,{__scopeCheckbox:d,checked:c,defaultChecked:s,disabled:u,required:r,onCheckedChange:b,name:n,form:C,value:i,internal_do_not_use_render:({isFormControl:f})=>e.jsxs(e.Fragment,{children:[e.jsx(B,{...p,ref:o,__scopeCheckbox:d}),f&&e.jsx(A,{__scopeCheckbox:d})]})})});M.displayName=v;var F="CheckboxIndicator",L=l.forwardRef((t,o)=>{const{__scopeCheckbox:d,forceMount:n,...c}=t,s=D(F,d);return e.jsx($,{present:n||g(s.checked)||s.checked===!0,children:e.jsx(I.span,{"data-state":q(s.checked),"data-disabled":s.disabled?"":void 0,...c,ref:o,style:{pointerEvents:"none",...t.style}})})});L.displayName=F;var O="CheckboxBubbleInput",A=l.forwardRef(({__scopeCheckbox:t,...o},d)=>{const{control:n,hasConsumerStoppedPropagationRef:c,checked:s,defaultChecked:r,required:u,disabled:i,name:b,value:C,form:p,bubbleInput:f,setBubbleInput:a}=D(O,t),m=_(d,a),k=se(s),j=K(n);l.useEffect(()=>{const x=f;if(!x)return;const N=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(N,"checked").set,z=!c.current;if(k!==s&&S){const H=new Event("click",{bubbles:z});x.indeterminate=g(s),S.call(x,g(s)?!1:s),x.dispatchEvent(H)}},[f,k,s,c]);const h=l.useRef(g(s)?!1:s);return e.jsx(I.input,{type:"checkbox","aria-hidden":!0,defaultChecked:r??h.current,required:u,disabled:i,name:b,value:C,form:p,...o,tabIndex:-1,ref:m,style:{...o.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});A.displayName=O;function pe(t){return typeof t=="function"}function g(t){return t==="indeterminate"}function q(t){return g(t)?"indeterminate":t?"checked":"unchecked"}function xe({className:t,...o}){return e.jsx(M,{"data-slot":"checkbox",className:U("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...o,children:e.jsx(L,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(te,{className:"size-3.5"})})})}function we({isOpen:t,onClose:o,onConfirm:d,task:n,milestones:c,currentMilestoneId:s}){const[r,u]=l.useState({targetMilestoneId:s,includeDependencies:!0,newTaskName:""}),[i,b]=l.useState(!1);if(l.useEffect(()=>{n&&t&&u({targetMilestoneId:s,includeDependencies:!0,newTaskName:`${n.name} (Copy)`})},[n,t,s]),!n)return null;const C=async()=>{b(!0);try{await d(r),o()}catch(a){console.error("Failed to clone task:",a)}finally{b(!1)}},p=c.find(a=>a.milestoneId===r.targetMilestoneId),f=r.targetMilestoneId===s;return e.jsx(V,{open:t,onOpenChange:o,children:e.jsxs(Y,{className:"max-w-md",children:[e.jsxs(J,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-blue-600"}),"Clone Task"]}),e.jsxs(W,{children:['Create a copy of "',n.name,'" with customizable options.']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"taskName",children:"New task name"}),e.jsx(ee,{id:"taskName",value:r.newTaskName,onChange:a=>u(m=>({...m,newTaskName:a.target.value})),placeholder:"Enter name for cloned task"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Target milestone"}),e.jsxs(ne,{value:r.targetMilestoneId,onValueChange:a=>u(m=>({...m,targetMilestoneId:a})),children:[e.jsx(ae,{children:e.jsx(re,{placeholder:"Select milestone"})}),e.jsx(oe,{children:c.map(a=>e.jsx(ce,{value:a.milestoneId,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:a.milestoneName}),a.milestoneId===s&&e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:"(current)"})]})},a.milestoneId))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{id:"includeDependencies",checked:r.includeDependencies,onCheckedChange:a=>u(m=>({...m,includeDependencies:a===!0}))}),e.jsxs(w,{htmlFor:"includeDependencies",className:"flex items-center gap-2",children:["Include dependencies",e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n.dependsOn.length," dependencies)"]})]})]}),e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Clone Summary:"}),e.jsxs("ul",{className:"text-muted-foreground mt-1 space-y-1",children:[e.jsxs("li",{children:['• Task: "',r.newTaskName||n.name,'"']}),e.jsxs("li",{children:["• Milestone: ",p?.milestoneName]}),e.jsxs("li",{children:["• Duration: ",n.durationDays," days"]}),e.jsxs("li",{children:["• Team: ",n.team]}),e.jsxs("li",{children:["• Dependencies:"," ",r.includeDependencies?`${n.dependsOn.length} included`:"None (excluded)"]})]})]})]})}),!f&&e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("div",{className:"font-medium",children:"Cross-milestone clone"}),e.jsx("div",{className:"mt-1",children:"Cloning to a different milestone may affect dependency relationships. Timeline will be recalculated after cloning."})]})]})})]}),e.jsxs(Z,{children:[e.jsxs(R,{variant:"outline",onClick:o,disabled:i,children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(R,{onClick:C,disabled:i||!r.newTaskName.trim(),className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),i?"Cloning...":"Clone Task"]})]})]})})}export{we as CloneTaskDialog};
