import{r as d,j as e,D as w,p as y,q as E,s as I,aN as g,u as F,L as j,I as M,v as L,B as u,X as k}from"./index-CfEYXZBA.js";import{T as P}from"./textarea-CI3xWn8i.js";import{C as f}from"./circle-check-big-wQvsvjyk.js";import{C as S}from"./circle-alert-DUfNsyZ5.js";function A({isOpen:o,onClose:m,onConfirm:v,milestone:a,milestones:C}){const[i,x]=d.useState({milestoneName:"",description:""}),[c,h]=d.useState(!1),[r,l]=d.useState([]);if(d.useEffect(()=>{a&&o&&(x({milestoneName:a.milestoneName,description:a.description||""}),l([]))},[a,o]),!a)return null;const D=()=>{const s=[];return i.milestoneName.trim()||s.push("Milestone name is required"),C.some(n=>n.milestoneId!==a.milestoneId&&n.milestoneName.toLowerCase()===i.milestoneName.trim().toLowerCase())&&s.push("A milestone with this name already exists"),s},b=async()=>{const s=D();if(s.length>0){l(s);return}h(!0);try{await v(a.milestoneId,{milestoneName:i.milestoneName.trim(),description:i.description.trim()||void 0}),m()}catch(t){console.error("Failed to update milestone:",t),l(["Failed to update milestone. Please try again."])}finally{h(!1)}},p=(s,t)=>{x(n=>({...n,[s]:t})),r.length>0&&l([])},N=i.milestoneName!==a.milestoneName||i.description!==(a.description||"");return e.jsx(w,{open:o,onOpenChange:m,children:e.jsxs(y,{className:"max-w-md",children:[e.jsxs(E,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-blue-600"}),"Edit Milestone"]}),e.jsxs(F,{children:['Modify the details of "',a.milestoneName,'".']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Milestone Details:"}),e.jsxs("div",{className:"text-muted-foreground mt-1",children:["• Tasks: ",a.tasks.length,"• ID: ",a.milestoneId]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"milestoneName",children:["Milestone Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(M,{id:"milestoneName",value:i.milestoneName,onChange:s=>p("milestoneName",s.target.value),placeholder:"Enter milestone name",className:r.some(s=>s.includes("name"))?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(P,{id:"description",value:i.description,onChange:s=>p("description",s.target.value),placeholder:"Enter milestone description...",rows:3,className:"resize-none"})]}),N&&e.jsx("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("div",{className:"font-medium",children:"Pending Changes:"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[i.milestoneName!==a.milestoneName&&e.jsxs("li",{className:"text-xs",children:['• Name: "',a.milestoneName,'" → "',i.milestoneName,'"']}),i.description!==(a.description||"")&&e.jsxs("li",{className:"text-xs",children:["• Description:"," ",i.description?"Updated":"Removed"]})]})]})]})}),r.length>0&&e.jsx("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-red-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("div",{className:"font-medium",children:"Please fix the following issues:"}),e.jsx("ul",{className:"mt-1 list-disc list-inside space-y-1",children:r.map((s,t)=>e.jsx("li",{children:s},t))})]})]})})]}),e.jsxs(L,{children:[e.jsxs(u,{variant:"outline",onClick:m,disabled:c,children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(u,{onClick:b,disabled:c||!N||r.length>0,className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"}),c?"Updating...":"Update Milestone"]})]})]})})}export{A as MilestoneEditDialog};
