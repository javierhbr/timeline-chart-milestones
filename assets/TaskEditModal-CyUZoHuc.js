import{c as nt,r as l,z as M,E as P,a1 as at,a9 as st,aa as ot,a4 as lt,H as G,j as t,$ as ee,ad as Fe,x as it,ae as ct,y as dt,a2 as Te,G as U,af as $e,ag as _e,ah as ut,ai as pt,aj as mt,ak as ft,al as vt,am as ht,an as xt,ao as gt,ap as bt,aq as Ce,D as yt,a as jt,b as wt,d as Ct,g as Ne,e as Nt,ar as kt,as as St,L as $,I as ke,at as Se,au as Ee,av as Pe,aw as De,ax as ce,ay as Re,s as Et,B as Q,T as Pt,i as Dt,az as Rt,aA as Ae,aB as Y,X as At}from"./index-Bsg0-DuV.js";import{T as It}from"./textarea-mcYi7L2p.js";import{S as Ot}from"./search-o0_8riO-.js";import{S as Mt}from"./save-BFGtCQmZ.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Tt=nt("link",Ft);var Ie=1,$t=.9,_t=.8,zt=.17,de=.1,ue=.999,Lt=.9999,qt=.99,Vt=/[\\\/_+.#"@\[\(\{&]/,Kt=/[\\\/_+.#"@\[\(\{&]/g,Bt=/[\s-]/,ze=/[\s-]/g;function me(e,n,r,d,s,a,c){if(a===n.length)return s===e.length?Ie:qt;var u=`${s},${a}`;if(c[u]!==void 0)return c[u];for(var b=d.charAt(a),p=r.indexOf(b,s),h=0,x,w,N,E;p>=0;)x=me(e,n,r,d,p+1,a+1,c),x>h&&(p===s?x*=Ie:Vt.test(e.charAt(p-1))?(x*=_t,N=e.slice(s,p-1).match(Kt),N&&s>0&&(x*=Math.pow(ue,N.length))):Bt.test(e.charAt(p-1))?(x*=$t,E=e.slice(s,p-1).match(ze),E&&s>0&&(x*=Math.pow(ue,E.length))):(x*=zt,s>0&&(x*=Math.pow(ue,p-s))),e.charAt(p)!==n.charAt(a)&&(x*=Lt)),(x<de&&r.charAt(p-1)===d.charAt(a+1)||d.charAt(a+1)===d.charAt(a)&&r.charAt(p-1)!==d.charAt(a))&&(w=me(e,n,r,d,p+1,a+2,c),w*de>x&&(x=w*de)),x>h&&(h=x),p=r.indexOf(b,p+1);return c[u]=h,h}function Oe(e){return e.toLowerCase().replace(ze," ")}function Ht(e,n,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,me(e,n,Oe(e),Oe(n),0,0,{})}var H='[cmdk-group=""]',pe='[cmdk-group-items=""]',Ut='[cmdk-group-heading=""]',Le='[cmdk-item=""]',Me=`${Le}:not([aria-disabled="true"])`,fe="cmdk-item-select",_="data-value",Gt=(e,n,r)=>Ht(e,n,r),qe=l.createContext(void 0),X=()=>l.useContext(qe),Ve=l.createContext(void 0),ve=()=>l.useContext(Ve),Ke=l.createContext(void 0),Be=l.forwardRef((e,n)=>{let r=z(()=>{var o,v;return{search:"",value:(v=(o=e.value)!=null?o:e.defaultValue)!=null?v:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=z(()=>new Set),s=z(()=>new Map),a=z(()=>new Map),c=z(()=>new Set),u=He(e),{label:b,children:p,value:h,onValueChange:x,filter:w,shouldFilter:N,loop:E,disablePointerSelection:R=!1,vimBindings:D=!0,...A}=e,q=M(),W=M(),V=M(),i=l.useRef(null),f=ar();F(()=>{if(h!==void 0){let o=h.trim();r.current.value=o,y.emit()}},[h]),F(()=>{f(6,ge)},[]);let y=l.useMemo(()=>({subscribe:o=>(c.current.add(o),()=>c.current.delete(o)),snapshot:()=>r.current,setState:(o,v,g)=>{var m,j,C,S;if(!Object.is(r.current[o],v)){if(r.current[o]=v,o==="search")oe(),ae(),f(1,se);else if(o==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let k=document.getElementById(V);k?k.focus():(m=document.getElementById(q))==null||m.focus()}if(f(7,()=>{var k;r.current.selectedItemId=(k=T())==null?void 0:k.id,y.emit()}),g||f(5,ge),((j=u.current)==null?void 0:j.value)!==void 0){let k=v??"";(S=(C=u.current).onValueChange)==null||S.call(C,k);return}}y.emit()}},emit:()=>{c.current.forEach(o=>o())}}),[]),K=l.useMemo(()=>({value:(o,v,g)=>{var m;v!==((m=a.current.get(o))==null?void 0:m.value)&&(a.current.set(o,{value:v,keywords:g}),r.current.filtered.items.set(o,xe(v,g)),f(2,()=>{ae(),y.emit()}))},item:(o,v)=>(d.current.add(o),v&&(s.current.has(v)?s.current.get(v).add(o):s.current.set(v,new Set([o]))),f(3,()=>{oe(),ae(),r.current.value||se(),y.emit()}),()=>{a.current.delete(o),d.current.delete(o),r.current.filtered.items.delete(o);let g=T();f(4,()=>{oe(),g?.getAttribute("id")===o&&se(),y.emit()})}),group:o=>(s.current.has(o)||s.current.set(o,new Set),()=>{a.current.delete(o),s.current.delete(o)}),filter:()=>u.current.shouldFilter,label:b||e["aria-label"],getDisablePointerSelection:()=>u.current.disablePointerSelection,listId:q,inputId:V,labelId:W,listInnerRef:i}),[]);function xe(o,v){var g,m;let j=(m=(g=u.current)==null?void 0:g.filter)!=null?m:Gt;return o?j(o,r.current.search,v):0}function ae(){if(!r.current.search||u.current.shouldFilter===!1)return;let o=r.current.filtered.items,v=[];r.current.filtered.groups.forEach(m=>{let j=s.current.get(m),C=0;j.forEach(S=>{let k=o.get(S);C=Math.max(k,C)}),v.push([m,C])});let g=i.current;B().sort((m,j)=>{var C,S;let k=m.getAttribute("id"),Z=j.getAttribute("id");return((C=o.get(Z))!=null?C:0)-((S=o.get(k))!=null?S:0)}).forEach(m=>{let j=m.closest(pe);j?j.appendChild(m.parentElement===j?m:m.closest(`${pe} > *`)):g.appendChild(m.parentElement===g?m:m.closest(`${pe} > *`))}),v.sort((m,j)=>j[1]-m[1]).forEach(m=>{var j;let C=(j=i.current)==null?void 0:j.querySelector(`${H}[${_}="${encodeURIComponent(m[0])}"]`);C?.parentElement.appendChild(C)})}function se(){let o=B().find(g=>g.getAttribute("aria-disabled")!=="true"),v=o?.getAttribute(_);y.setState("value",v||void 0)}function oe(){var o,v,g,m;if(!r.current.search||u.current.shouldFilter===!1){r.current.filtered.count=d.current.size;return}r.current.filtered.groups=new Set;let j=0;for(let C of d.current){let S=(v=(o=a.current.get(C))==null?void 0:o.value)!=null?v:"",k=(m=(g=a.current.get(C))==null?void 0:g.keywords)!=null?m:[],Z=xe(S,k);r.current.filtered.items.set(C,Z),Z>0&&j++}for(let[C,S]of s.current)for(let k of S)if(r.current.filtered.items.get(k)>0){r.current.filtered.groups.add(C);break}r.current.filtered.count=j}function ge(){var o,v,g;let m=T();m&&(((o=m.parentElement)==null?void 0:o.firstChild)===m&&((g=(v=m.closest(H))==null?void 0:v.querySelector(Ut))==null||g.scrollIntoView({block:"nearest"})),m.scrollIntoView({block:"nearest"}))}function T(){var o;return(o=i.current)==null?void 0:o.querySelector(`${Le}[aria-selected="true"]`)}function B(){var o;return Array.from(((o=i.current)==null?void 0:o.querySelectorAll(Me))||[])}function le(o){let v=B()[o];v&&y.setState("value",v.getAttribute(_))}function ie(o){var v;let g=T(),m=B(),j=m.findIndex(S=>S===g),C=m[j+o];(v=u.current)!=null&&v.loop&&(C=j+o<0?m[m.length-1]:j+o===m.length?m[0]:m[j+o]),C&&y.setState("value",C.getAttribute(_))}function be(o){let v=T(),g=v?.closest(H),m;for(;g&&!m;)g=o>0?rr(g,H):nr(g,H),m=g?.querySelector(Me);m?y.setState("value",m.getAttribute(_)):ie(o)}let ye=()=>le(B().length-1),je=o=>{o.preventDefault(),o.metaKey?ye():o.altKey?be(1):ie(1)},we=o=>{o.preventDefault(),o.metaKey?le(0):o.altKey?be(-1):ie(-1)};return l.createElement(P.div,{ref:n,tabIndex:-1,...A,"cmdk-root":"",onKeyDown:o=>{var v;(v=A.onKeyDown)==null||v.call(A,o);let g=o.nativeEvent.isComposing||o.keyCode===229;if(!(o.defaultPrevented||g))switch(o.key){case"n":case"j":{D&&o.ctrlKey&&je(o);break}case"ArrowDown":{je(o);break}case"p":case"k":{D&&o.ctrlKey&&we(o);break}case"ArrowUp":{we(o);break}case"Home":{o.preventDefault(),le(0);break}case"End":{o.preventDefault(),ye();break}case"Enter":{o.preventDefault();let m=T();if(m){let j=new Event(fe);m.dispatchEvent(j)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:K.inputId,id:K.labelId,style:or},b),re(e,o=>l.createElement(Ve.Provider,{value:y},l.createElement(qe.Provider,{value:K},o))))}),Xt=l.forwardRef((e,n)=>{var r,d;let s=M(),a=l.useRef(null),c=l.useContext(Ke),u=X(),b=He(e),p=(d=(r=b.current)==null?void 0:r.forceMount)!=null?d:c?.forceMount;F(()=>{if(!p)return u.item(s,c?.id)},[p]);let h=Ue(s,a,[e.value,e.children,a],e.keywords),x=ve(),w=I(f=>f.value&&f.value===h.current),N=I(f=>p||u.filter()===!1?!0:f.search?f.filtered.items.get(s)>0:!0);l.useEffect(()=>{let f=a.current;if(!(!f||e.disabled))return f.addEventListener(fe,E),()=>f.removeEventListener(fe,E)},[N,e.onSelect,e.disabled]);function E(){var f,y;R(),(y=(f=b.current).onSelect)==null||y.call(f,h.current)}function R(){x.setState("value",h.current,!0)}if(!N)return null;let{disabled:D,value:A,onSelect:q,forceMount:W,keywords:V,...i}=e;return l.createElement(P.div,{ref:G(a,n),...i,id:s,"cmdk-item":"",role:"option","aria-disabled":!!D,"aria-selected":!!w,"data-disabled":!!D,"data-selected":!!w,onPointerMove:D||u.getDisablePointerSelection()?void 0:R,onClick:D?void 0:E},e.children)}),Jt=l.forwardRef((e,n)=>{let{heading:r,children:d,forceMount:s,...a}=e,c=M(),u=l.useRef(null),b=l.useRef(null),p=M(),h=X(),x=I(N=>s||h.filter()===!1?!0:N.search?N.filtered.groups.has(c):!0);F(()=>h.group(c),[]),Ue(c,u,[e.value,e.heading,b]);let w=l.useMemo(()=>({id:c,forceMount:s}),[s]);return l.createElement(P.div,{ref:G(u,n),...a,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},r&&l.createElement("div",{ref:b,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),re(e,N=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0},l.createElement(Ke.Provider,{value:w},N))))}),Wt=l.forwardRef((e,n)=>{let{alwaysRender:r,...d}=e,s=l.useRef(null),a=I(c=>!c.search);return!r&&!a?null:l.createElement(P.div,{ref:G(s,n),...d,"cmdk-separator":"",role:"separator"})}),Zt=l.forwardRef((e,n)=>{let{onValueChange:r,...d}=e,s=e.value!=null,a=ve(),c=I(p=>p.search),u=I(p=>p.selectedItemId),b=X();return l.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),l.createElement(P.input,{ref:n,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":b.listId,"aria-labelledby":b.labelId,"aria-activedescendant":u,id:b.inputId,type:"text",value:s?e.value:c,onChange:p=>{s||a.setState("search",p.target.value),r?.(p.target.value)}})}),Qt=l.forwardRef((e,n)=>{let{children:r,label:d="Suggestions",...s}=e,a=l.useRef(null),c=l.useRef(null),u=I(p=>p.selectedItemId),b=X();return l.useEffect(()=>{if(c.current&&a.current){let p=c.current,h=a.current,x,w=new ResizeObserver(()=>{x=requestAnimationFrame(()=>{let N=p.offsetHeight;h.style.setProperty("--cmdk-list-height",N.toFixed(1)+"px")})});return w.observe(p),()=>{cancelAnimationFrame(x),w.unobserve(p)}}},[]),l.createElement(P.div,{ref:G(a,n),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":u,"aria-label":d,id:b.listId},re(e,p=>l.createElement("div",{ref:G(c,b.listInnerRef),"cmdk-list-sizer":""},p)))}),Yt=l.forwardRef((e,n)=>{let{open:r,onOpenChange:d,overlayClassName:s,contentClassName:a,container:c,...u}=e;return l.createElement(at,{open:r,onOpenChange:d},l.createElement(st,{container:c},l.createElement(ot,{"cmdk-overlay":"",className:s}),l.createElement(lt,{"aria-label":e.label,"cmdk-dialog":"",className:a},l.createElement(Be,{ref:n,...u}))))}),er=l.forwardRef((e,n)=>I(r=>r.filtered.count===0)?l.createElement(P.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),tr=l.forwardRef((e,n)=>{let{progress:r,children:d,label:s="Loading...",...a}=e;return l.createElement(P.div,{ref:n,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},re(e,c=>l.createElement("div",{"aria-hidden":!0},c)))}),te=Object.assign(Be,{List:Qt,Item:Xt,Input:Zt,Group:Jt,Separator:Wt,Dialog:Yt,Empty:er,Loading:tr});function rr(e,n){let r=e.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function nr(e,n){let r=e.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function He(e){let n=l.useRef(e);return F(()=>{n.current=e}),n}var F=typeof window>"u"?l.useEffect:l.useLayoutEffect;function z(e){let n=l.useRef();return n.current===void 0&&(n.current=e()),n}function I(e){let n=ve(),r=()=>e(n.snapshot());return l.useSyncExternalStore(n.subscribe,r,r)}function Ue(e,n,r,d=[]){let s=l.useRef(),a=X();return F(()=>{var c;let u=(()=>{var p;for(let h of r){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(p=h.current.textContent)==null?void 0:p.trim():s.current}})(),b=d.map(p=>p.trim());a.value(e,u,b),(c=n.current)==null||c.setAttribute(_,u),s.current=u}),s}var ar=()=>{let[e,n]=l.useState(),r=z(()=>new Map);return F(()=>{r.current.forEach(d=>d()),r.current=new Map},[e]),(d,s)=>{r.current.set(d,s),n({})}};function sr(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function re({asChild:e,children:n},r){return e&&l.isValidElement(n)?l.cloneElement(sr(n),{ref:n.ref},r(n.props.children)):r(n)}var or={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function lr({className:e,...n}){return t.jsx(te,{"data-slot":"command",className:ee("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...n})}function ir({className:e,...n}){return t.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[t.jsx(Ot,{className:"size-4 shrink-0 opacity-50"}),t.jsx(te.Input,{"data-slot":"command-input",className:ee("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...n})]})}function cr({...e}){return t.jsx(te.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function dr({className:e,...n}){return t.jsx(te.Item,{"data-slot":"command-item",className:ee("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}var ne="Popover",[Ge,Mr]=dt(ne,[Fe]),J=Fe(),[ur,O]=Ge(ne),Xe=e=>{const{__scopePopover:n,children:r,open:d,defaultOpen:s,onOpenChange:a,modal:c=!1}=e,u=J(n),b=l.useRef(null),[p,h]=l.useState(!1),[x,w]=it({prop:d,defaultProp:s??!1,onChange:a,caller:ne});return t.jsx(ct,{...u,children:t.jsx(ur,{scope:n,contentId:M(),triggerRef:b,open:x,onOpenChange:w,onOpenToggle:l.useCallback(()=>w(N=>!N),[w]),hasCustomAnchor:p,onCustomAnchorAdd:l.useCallback(()=>h(!0),[]),onCustomAnchorRemove:l.useCallback(()=>h(!1),[]),modal:c,children:r})})};Xe.displayName=ne;var Je="PopoverAnchor",pr=l.forwardRef((e,n)=>{const{__scopePopover:r,...d}=e,s=O(Je,r),a=J(r),{onCustomAnchorAdd:c,onCustomAnchorRemove:u}=s;return l.useEffect(()=>(c(),()=>u()),[c,u]),t.jsx($e,{...a,...d,ref:n})});pr.displayName=Je;var We="PopoverTrigger",Ze=l.forwardRef((e,n)=>{const{__scopePopover:r,...d}=e,s=O(We,r),a=J(r),c=Te(n,s.triggerRef),u=t.jsx(P.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":rt(s.open),...d,ref:c,onClick:U(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?u:t.jsx($e,{asChild:!0,...a,children:u})});Ze.displayName=We;var he="PopoverPortal",[mr,fr]=Ge(he,{forceMount:void 0}),Qe=e=>{const{__scopePopover:n,forceMount:r,children:d,container:s}=e,a=O(he,n);return t.jsx(mr,{scope:n,forceMount:r,children:t.jsx(_e,{present:r||a.open,children:t.jsx(ut,{asChild:!0,container:s,children:d})})})};Qe.displayName=he;var L="PopoverContent",Ye=l.forwardRef((e,n)=>{const r=fr(L,e.__scopePopover),{forceMount:d=r.forceMount,...s}=e,a=O(L,e.__scopePopover);return t.jsx(_e,{present:d||a.open,children:a.modal?t.jsx(hr,{...s,ref:n}):t.jsx(xr,{...s,ref:n})})});Ye.displayName=L;var vr=ft("PopoverContent.RemoveScroll"),hr=l.forwardRef((e,n)=>{const r=O(L,e.__scopePopover),d=l.useRef(null),s=Te(n,d),a=l.useRef(!1);return l.useEffect(()=>{const c=d.current;if(c)return pt(c)},[]),t.jsx(mt,{as:vr,allowPinchZoom:!0,children:t.jsx(et,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:U(e.onCloseAutoFocus,c=>{c.preventDefault(),a.current||r.triggerRef.current?.focus()}),onPointerDownOutside:U(e.onPointerDownOutside,c=>{const u=c.detail.originalEvent,b=u.button===0&&u.ctrlKey===!0,p=u.button===2||b;a.current=p},{checkForDefaultPrevented:!1}),onFocusOutside:U(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),xr=l.forwardRef((e,n)=>{const r=O(L,e.__scopePopover),d=l.useRef(!1),s=l.useRef(!1);return t.jsx(et,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(d.current||r.triggerRef.current?.focus(),a.preventDefault()),d.current=!1,s.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(d.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=a.target;r.triggerRef.current?.contains(c)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),et=l.forwardRef((e,n)=>{const{__scopePopover:r,trapFocus:d,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:b,onFocusOutside:p,onInteractOutside:h,...x}=e,w=O(L,r),N=J(r);return vt(),t.jsx(ht,{asChild:!0,loop:!0,trapped:d,onMountAutoFocus:s,onUnmountAutoFocus:a,children:t.jsx(xt,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:h,onEscapeKeyDown:u,onPointerDownOutside:b,onFocusOutside:p,onDismiss:()=>w.onOpenChange(!1),children:t.jsx(gt,{"data-state":rt(w.open),role:"dialog",id:w.contentId,...N,...x,ref:n,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),tt="PopoverClose",gr=l.forwardRef((e,n)=>{const{__scopePopover:r,...d}=e,s=O(tt,r);return t.jsx(P.button,{type:"button",...d,ref:n,onClick:U(e.onClick,()=>s.onOpenChange(!1))})});gr.displayName=tt;var br="PopoverArrow",yr=l.forwardRef((e,n)=>{const{__scopePopover:r,...d}=e,s=J(r);return t.jsx(bt,{...s,...d,ref:n})});yr.displayName=br;function rt(e){return e?"open":"closed"}var jr=Xe,wr=Ze,Cr=Qe,Nr=Ye;function kr({...e}){return t.jsx(jr,{"data-slot":"popover",...e})}function Sr({...e}){return t.jsx(wr,{"data-slot":"popover-trigger",...e})}function Er({className:e,align:n="center",sideOffset:r=4,...d}){return t.jsx(Cr,{children:t.jsx(Nr,{"data-slot":"popover-content",align:n,sideOffset:r,className:ee("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...d})})}function Pr(e){const n=new Set;e.forEach(d=>{d.tasks.forEach(s=>{s.team&&s.team.trim()&&n.add(s.team)})});const r=Array.from(n).sort();return r.length===0?["Dev","QA","Design","PM","UX","UI","Backend","Frontend","Marketing"]:r}function Dr(e){const n=new Set;e.forEach(d=>{d.tasks.forEach(s=>{s.sprint&&s.sprint.trim()&&n.add(s.sprint)})});const r=Array.from(n).sort();return r.length===0?["Sprint 1","Sprint 2","Sprint 3","Sprint 4","Sprint 5","Backlog","Icebox"]:r}function Fr({task:e,isOpen:n,onClose:r,onSave:d,milestones:s}){const[a,c]=l.useState({name:"",description:"",team:"",sprint:"",durationDays:1,dependsOn:[]}),[u,b]=l.useState({}),[p,h]=l.useState(!1),x=Ce.useMemo(()=>Pr(s),[s]),w=Ce.useMemo(()=>Dr(s),[s]);l.useEffect(()=>{if(n){if(e)c({name:e.name,description:e.description,team:e.team,sprint:e.sprint||"",durationDays:e.durationDays,dependsOn:e.dependsOn||[]});else{const i=x.length>0?x[0]:"Dev",f=w.length>0?w[0]:"";c({name:"",description:"",team:i,sprint:f,durationDays:1,dependsOn:[]})}b({})}},[e,n,x,w]),l.useEffect(()=>{if(n&&e){const i=e.dependsOn||[];c(f=>JSON.stringify(f.dependsOn)!==JSON.stringify(i)?{...f,dependsOn:i}:f)}},[n,e?.dependsOn]);const N=()=>{const i={};return a.name.trim()||(i.name="Name is required"),a.team||(i.team="Team is required"),a.durationDays<1&&(i.durationDays="Duration must be at least 1 day"),a.durationDays>365&&(i.durationDays="Duration cannot exceed 365 days"),b(i),Object.keys(i).length===0},E=()=>{if(!N())return;const i={name:a.name.trim(),description:a.description.trim(),team:a.team,sprint:a.sprint==="none"?void 0:a.sprint||void 0,durationDays:a.durationDays,dependsOn:a.dependsOn},f=e?e.taskId:"new-task-placeholder";d(f,i),r()},R=(i,f)=>{c(y=>({...y,[i]:f})),u[i]&&b(y=>({...y,[i]:""}))},D=i=>{const f=i.target.value;if(f==="")R("durationDays",1);else{const y=parseInt(f);!isNaN(y)&&y>=1&&y<=365&&R("durationDays",y)}},A=s.flatMap(i=>i.tasks.filter(f=>f.taskId!==e?.taskId)),q=i=>{a.dependsOn.includes(i)||c(f=>({...f,dependsOn:[...f.dependsOn,i]})),h(!1)},W=i=>{c(f=>({...f,dependsOn:f.dependsOn.filter(y=>y!==i)}))},V=i=>{for(const f of s){const y=f.tasks.find(K=>K.taskId===i);if(y)return{task:y,milestone:f.milestoneName}}return null};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
        .task-edit-modal {
          width: 60vw !important;
          max-width: 60vw !important;
          min-width: 60vw !important;
        }
        .task-edit-modal[data-slot="dialog-content"] {
          width: 60vw !important;
          max-width: 60vw !important;
        }
        /* Fix z-index for dropdowns inside modal */
        .task-edit-modal [data-radix-popper-content-wrapper] {
          z-index: 10000 !important;
        }
        .task-edit-modal [data-radix-select-content] {
          z-index: 10002 !important;
        }
        .task-edit-modal [data-radix-popover-content] {
          z-index: 10001 !important;
        }
      `}),t.jsx(yt,{open:n,onOpenChange:r,children:t.jsxs(jt,{className:"max-h-[90vh] task-edit-modal",style:{zIndex:9999},children:[t.jsxs(wt,{children:[t.jsxs(Ct,{className:"flex items-center gap-2",children:[t.jsx(Ne,{className:"w-5 h-5"}),e?"Edit Task":"Create New Task"]}),t.jsx(Nt,{children:e?"Modify task details, assign teams, set duration, and manage dependencies.":"Create a new task with details, team assignment, duration, and dependencies."})]}),t.jsx("div",{className:"max-h-[70vh] overflow-y-auto pr-2",children:t.jsxs("div",{className:"space-y-4",children:[e&&e.startDate&&e.endDate&&t.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Ne,{className:"w-4 h-4"}),"Project dates"]}),t.jsx("div",{className:"text-sm",children:kt(e.startDate,e.endDate,"dd/MM/yyyy",{locale:St})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{htmlFor:"taskName",children:"Task name *"}),t.jsx(ke,{id:"taskName",value:a.name,onChange:i=>R("name",i.target.value),placeholder:"E.g.: Create initial wireframes",className:u.name?"border-destructive":""}),u.name&&t.jsx("p",{className:"text-sm text-destructive",children:u.name})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{htmlFor:"taskDescription",children:"Description"}),t.jsx(It,{id:"taskDescription",value:a.description,onChange:i=>c({...a,description:i.target.value}),placeholder:"Detailed task description...",className:"min-h-[100px]"})]}),t.jsxs("div",{className:"flex flex-row gap-4 items-start",children:[t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsx($,{children:"Assigned team *"}),t.jsxs(Se,{value:a.team,onValueChange:i=>c({...a,team:i}),children:[t.jsx(Ee,{className:u.team?"border-red-500":"",children:t.jsx(Pe,{placeholder:"Select team"})}),t.jsx(De,{style:{zIndex:1e4},children:x.map(i=>t.jsx(ce,{value:i,children:i},i))})]}),u.team&&t.jsx("p",{className:"text-sm text-destructive",children:u.team})]}),t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsxs($,{className:"flex items-center gap-2",children:[t.jsx(Re,{className:"w-4 h-4"}),"Assigned sprint"]}),t.jsxs(Se,{value:a.sprint,onValueChange:i=>R("sprint",i),children:[t.jsx(Ee,{children:t.jsx(Pe,{placeholder:"Select sprint (optional)"})}),t.jsxs(De,{style:{zIndex:1e4},children:[t.jsx(ce,{value:"none",children:"No sprint assigned"}),w.map(i=>t.jsx(ce,{value:i,children:i},i))]})]})]}),t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsxs($,{htmlFor:"duration",className:"flex items-center gap-2",children:[t.jsx(Et,{className:"w-4 h-4"}),"Duration in working days *"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ke,{id:"duration",type:"number",min:"1",max:"365",value:a.durationDays,onChange:D,className:`w-24 ${u.durationDays?"border-destructive":""}`}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"days"})]}),u.durationDays&&t.jsx("p",{className:"text-sm text-destructive",children:u.durationDays})]})]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Excludes weekends from calculation"}),t.jsx("hr",{className:"my-6 border-muted"}),t.jsxs("div",{className:"space-y-3 border-2 border-blue-200 rounded-lg p-4 bg-blue-50/30",children:[t.jsxs($,{className:"flex items-center gap-2 text-base font-semibold",children:[t.jsx(Tt,{className:"w-5 h-5 text-blue-600"}),"Task Dependencies"]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Select tasks that must be completed before this task can start"}),a.dependsOn.length>0&&t.jsx("div",{className:"space-y-1 mb-3",children:a.dependsOn.map(i=>{const f=V(i);return f?t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium",children:f.task.name}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[f.milestone," • ",f.task.team]})]}),t.jsx(Q,{type:"button",variant:"ghost",size:"sm",onClick:()=>W(i),className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",children:t.jsx(Pt,{className:"w-3 h-3"})})]},i):null})}),A.length>0?t.jsxs(kr,{open:p,onOpenChange:h,children:[t.jsx(Sr,{asChild:!0,children:t.jsxs(Q,{variant:"outline",role:"combobox","aria-expanded":p,className:"w-full justify-between h-10 font-normal text-sm",children:["Add task dependency... (",A.length," ","available)",t.jsx(Dt,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),t.jsx(Er,{className:"w-full p-0",style:{zIndex:10001,maxHeight:"400px"},children:t.jsxs(lr,{children:[t.jsx(ir,{placeholder:"Search tasks...",className:"h-9"}),t.jsx(cr,{className:"py-6 text-center text-sm",children:"No tasks found."}),t.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:A.filter(i=>!a.dependsOn.includes(i.taskId)).map(i=>t.jsx(dr,{value:`${i.name} ${i.taskId} ${i.team}`,onSelect:()=>q(i.taskId),className:"cursor-pointer",children:t.jsxs("div",{className:"flex items-center justify-between w-full gap-2",children:[t.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium truncate text-sm",children:i.name}),t.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",i.team,")"]})]}),t.jsx("span",{className:"text-xs text-muted-foreground font-mono whitespace-nowrap",children:i.taskId})]})},i.taskId))})]})})]}):t.jsx("div",{className:"p-3 text-center text-sm text-muted-foreground border border-dashed rounded-lg",children:"No other tasks available for dependencies"})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Rt,{className:"w-4 h-4 text-muted-foreground"}),t.jsx(Ae,{variant:"outline",style:{borderColor:Y[a.team]||Y.Default,color:Y[a.team]||Y.Default},children:a.team||"No team"})]}),a.sprint&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Re,{className:"w-4 h-4 text-muted-foreground"}),t.jsx(Ae,{variant:"secondary",children:a.sprint})]})]})]})}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsxs(Q,{onClick:E,className:"flex-1 flex items-center gap-2",children:[t.jsx(Mt,{className:"w-4 h-4"}),e?"Save changes":"Create task"]}),t.jsxs(Q,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[t.jsx(At,{className:"w-4 h-4"}),"Cancel"]})]})]})})]})}export{Fr as TaskEditModal};
