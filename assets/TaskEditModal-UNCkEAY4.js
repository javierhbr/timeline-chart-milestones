import{c as ot,r as l,J as M,M as E,a6 as lt,ae as it,af as ct,a9 as dt,O as G,j as t,a4 as ee,ai as $e,G as ut,aj as pt,H as mt,a7 as ze,N as U,ak as Le,al as qe,am as ft,an as vt,ao as ht,ap as xt,aq as gt,ar as bt,as as yt,at as jt,au as wt,av as Ce,D as Ct,a as Nt,b as kt,d as St,g as Ne,e as Pt,aw as ke,ax as Se,ay as Pe,L as _,I as Ee,az as De,x as Et,B as Q,T as Dt,h as Rt,aA as It,aB as Re,aC as Y,X as At}from"./index-CcMe2jfa.js";import{T as Ot}from"./textarea--0kamiQl.js";import{S as Ie,a as Ae,b as Oe,c as Me,d as ce}from"./select-CGGloa1V.js";import{S as Mt}from"./search-BDoL9iEL.js";import{S as Ft}from"./save-C9NiqDJP.js";import"./index-BQsvseK8.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],_t=ot("link",Tt);var Fe=1,$t=.9,zt=.8,Lt=.17,de=.1,ue=.999,qt=.9999,Vt=.99,Kt=/[\\\/_+.#"@\[\(\{&]/,Bt=/[\\\/_+.#"@\[\(\{&]/g,Ht=/[\s-]/,Ve=/[\s-]/g;function me(e,n,r,c,s,a,d){if(a===n.length)return s===e.length?Fe:Vt;var u=`${s},${a}`;if(d[u]!==void 0)return d[u];for(var b=c.charAt(a),p=r.indexOf(b,s),h=0,x,w,N,P;p>=0;)x=me(e,n,r,c,p+1,a+1,d),x>h&&(p===s?x*=Fe:Kt.test(e.charAt(p-1))?(x*=zt,N=e.slice(s,p-1).match(Bt),N&&s>0&&(x*=Math.pow(ue,N.length))):Ht.test(e.charAt(p-1))?(x*=$t,P=e.slice(s,p-1).match(Ve),P&&s>0&&(x*=Math.pow(ue,P.length))):(x*=Lt,s>0&&(x*=Math.pow(ue,p-s))),e.charAt(p)!==n.charAt(a)&&(x*=qt)),(x<de&&r.charAt(p-1)===c.charAt(a+1)||c.charAt(a+1)===c.charAt(a)&&r.charAt(p-1)!==c.charAt(a))&&(w=me(e,n,r,c,p+1,a+2,d),w*de>x&&(x=w*de)),x>h&&(h=x),p=r.indexOf(b,p+1);return d[u]=h,h}function Te(e){return e.toLowerCase().replace(Ve," ")}function Ut(e,n,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,me(e,n,Te(e),Te(n),0,0,{})}var H='[cmdk-group=""]',pe='[cmdk-group-items=""]',Gt='[cmdk-group-heading=""]',Ke='[cmdk-item=""]',_e=`${Ke}:not([aria-disabled="true"])`,fe="cmdk-item-select",$="data-value",Xt=(e,n,r)=>Ut(e,n,r),Be=l.createContext(void 0),X=()=>l.useContext(Be),He=l.createContext(void 0),ve=()=>l.useContext(He),Ue=l.createContext(void 0),Ge=l.forwardRef((e,n)=>{let r=z(()=>{var o,v;return{search:"",value:(v=(o=e.value)!=null?o:e.defaultValue)!=null?v:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),c=z(()=>new Set),s=z(()=>new Map),a=z(()=>new Map),d=z(()=>new Set),u=Xe(e),{label:b,children:p,value:h,onValueChange:x,filter:w,shouldFilter:N,loop:P,disablePointerSelection:R=!1,vimBindings:D=!0,...I}=e,q=M(),J=M(),V=M(),i=l.useRef(null),f=sr();F(()=>{if(h!==void 0){let o=h.trim();r.current.value=o,y.emit()}},[h]),F(()=>{f(6,ge)},[]);let y=l.useMemo(()=>({subscribe:o=>(d.current.add(o),()=>d.current.delete(o)),snapshot:()=>r.current,setState:(o,v,g)=>{var m,j,C,S;if(!Object.is(r.current[o],v)){if(r.current[o]=v,o==="search")oe(),ae(),f(1,se);else if(o==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let k=document.getElementById(V);k?k.focus():(m=document.getElementById(q))==null||m.focus()}if(f(7,()=>{var k;r.current.selectedItemId=(k=T())==null?void 0:k.id,y.emit()}),g||f(5,ge),((j=u.current)==null?void 0:j.value)!==void 0){let k=v??"";(S=(C=u.current).onValueChange)==null||S.call(C,k);return}}y.emit()}},emit:()=>{d.current.forEach(o=>o())}}),[]),K=l.useMemo(()=>({value:(o,v,g)=>{var m;v!==((m=a.current.get(o))==null?void 0:m.value)&&(a.current.set(o,{value:v,keywords:g}),r.current.filtered.items.set(o,xe(v,g)),f(2,()=>{ae(),y.emit()}))},item:(o,v)=>(c.current.add(o),v&&(s.current.has(v)?s.current.get(v).add(o):s.current.set(v,new Set([o]))),f(3,()=>{oe(),ae(),r.current.value||se(),y.emit()}),()=>{a.current.delete(o),c.current.delete(o),r.current.filtered.items.delete(o);let g=T();f(4,()=>{oe(),g?.getAttribute("id")===o&&se(),y.emit()})}),group:o=>(s.current.has(o)||s.current.set(o,new Set),()=>{a.current.delete(o),s.current.delete(o)}),filter:()=>u.current.shouldFilter,label:b||e["aria-label"],getDisablePointerSelection:()=>u.current.disablePointerSelection,listId:q,inputId:V,labelId:J,listInnerRef:i}),[]);function xe(o,v){var g,m;let j=(m=(g=u.current)==null?void 0:g.filter)!=null?m:Xt;return o?j(o,r.current.search,v):0}function ae(){if(!r.current.search||u.current.shouldFilter===!1)return;let o=r.current.filtered.items,v=[];r.current.filtered.groups.forEach(m=>{let j=s.current.get(m),C=0;j.forEach(S=>{let k=o.get(S);C=Math.max(k,C)}),v.push([m,C])});let g=i.current;B().sort((m,j)=>{var C,S;let k=m.getAttribute("id"),Z=j.getAttribute("id");return((C=o.get(Z))!=null?C:0)-((S=o.get(k))!=null?S:0)}).forEach(m=>{let j=m.closest(pe);j?j.appendChild(m.parentElement===j?m:m.closest(`${pe} > *`)):g.appendChild(m.parentElement===g?m:m.closest(`${pe} > *`))}),v.sort((m,j)=>j[1]-m[1]).forEach(m=>{var j;let C=(j=i.current)==null?void 0:j.querySelector(`${H}[${$}="${encodeURIComponent(m[0])}"]`);C?.parentElement.appendChild(C)})}function se(){let o=B().find(g=>g.getAttribute("aria-disabled")!=="true"),v=o?.getAttribute($);y.setState("value",v||void 0)}function oe(){var o,v,g,m;if(!r.current.search||u.current.shouldFilter===!1){r.current.filtered.count=c.current.size;return}r.current.filtered.groups=new Set;let j=0;for(let C of c.current){let S=(v=(o=a.current.get(C))==null?void 0:o.value)!=null?v:"",k=(m=(g=a.current.get(C))==null?void 0:g.keywords)!=null?m:[],Z=xe(S,k);r.current.filtered.items.set(C,Z),Z>0&&j++}for(let[C,S]of s.current)for(let k of S)if(r.current.filtered.items.get(k)>0){r.current.filtered.groups.add(C);break}r.current.filtered.count=j}function ge(){var o,v,g;let m=T();m&&(((o=m.parentElement)==null?void 0:o.firstChild)===m&&((g=(v=m.closest(H))==null?void 0:v.querySelector(Gt))==null||g.scrollIntoView({block:"nearest"})),m.scrollIntoView({block:"nearest"}))}function T(){var o;return(o=i.current)==null?void 0:o.querySelector(`${Ke}[aria-selected="true"]`)}function B(){var o;return Array.from(((o=i.current)==null?void 0:o.querySelectorAll(_e))||[])}function le(o){let v=B()[o];v&&y.setState("value",v.getAttribute($))}function ie(o){var v;let g=T(),m=B(),j=m.findIndex(S=>S===g),C=m[j+o];(v=u.current)!=null&&v.loop&&(C=j+o<0?m[m.length-1]:j+o===m.length?m[0]:m[j+o]),C&&y.setState("value",C.getAttribute($))}function be(o){let v=T(),g=v?.closest(H),m;for(;g&&!m;)g=o>0?nr(g,H):ar(g,H),m=g?.querySelector(_e);m?y.setState("value",m.getAttribute($)):ie(o)}let ye=()=>le(B().length-1),je=o=>{o.preventDefault(),o.metaKey?ye():o.altKey?be(1):ie(1)},we=o=>{o.preventDefault(),o.metaKey?le(0):o.altKey?be(-1):ie(-1)};return l.createElement(E.div,{ref:n,tabIndex:-1,...I,"cmdk-root":"",onKeyDown:o=>{var v;(v=I.onKeyDown)==null||v.call(I,o);let g=o.nativeEvent.isComposing||o.keyCode===229;if(!(o.defaultPrevented||g))switch(o.key){case"n":case"j":{D&&o.ctrlKey&&je(o);break}case"ArrowDown":{je(o);break}case"p":case"k":{D&&o.ctrlKey&&we(o);break}case"ArrowUp":{we(o);break}case"Home":{o.preventDefault(),le(0);break}case"End":{o.preventDefault(),ye();break}case"Enter":{o.preventDefault();let m=T();if(m){let j=new Event(fe);m.dispatchEvent(j)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:K.inputId,id:K.labelId,style:lr},b),re(e,o=>l.createElement(He.Provider,{value:y},l.createElement(Be.Provider,{value:K},o))))}),Wt=l.forwardRef((e,n)=>{var r,c;let s=M(),a=l.useRef(null),d=l.useContext(Ue),u=X(),b=Xe(e),p=(c=(r=b.current)==null?void 0:r.forceMount)!=null?c:d?.forceMount;F(()=>{if(!p)return u.item(s,d?.id)},[p]);let h=We(s,a,[e.value,e.children,a],e.keywords),x=ve(),w=A(f=>f.value&&f.value===h.current),N=A(f=>p||u.filter()===!1?!0:f.search?f.filtered.items.get(s)>0:!0);l.useEffect(()=>{let f=a.current;if(!(!f||e.disabled))return f.addEventListener(fe,P),()=>f.removeEventListener(fe,P)},[N,e.onSelect,e.disabled]);function P(){var f,y;R(),(y=(f=b.current).onSelect)==null||y.call(f,h.current)}function R(){x.setState("value",h.current,!0)}if(!N)return null;let{disabled:D,value:I,onSelect:q,forceMount:J,keywords:V,...i}=e;return l.createElement(E.div,{ref:G(a,n),...i,id:s,"cmdk-item":"",role:"option","aria-disabled":!!D,"aria-selected":!!w,"data-disabled":!!D,"data-selected":!!w,onPointerMove:D||u.getDisablePointerSelection()?void 0:R,onClick:D?void 0:P},e.children)}),Jt=l.forwardRef((e,n)=>{let{heading:r,children:c,forceMount:s,...a}=e,d=M(),u=l.useRef(null),b=l.useRef(null),p=M(),h=X(),x=A(N=>s||h.filter()===!1?!0:N.search?N.filtered.groups.has(d):!0);F(()=>h.group(d),[]),We(d,u,[e.value,e.heading,b]);let w=l.useMemo(()=>({id:d,forceMount:s}),[s]);return l.createElement(E.div,{ref:G(u,n),...a,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},r&&l.createElement("div",{ref:b,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),re(e,N=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0},l.createElement(Ue.Provider,{value:w},N))))}),Zt=l.forwardRef((e,n)=>{let{alwaysRender:r,...c}=e,s=l.useRef(null),a=A(d=>!d.search);return!r&&!a?null:l.createElement(E.div,{ref:G(s,n),...c,"cmdk-separator":"",role:"separator"})}),Qt=l.forwardRef((e,n)=>{let{onValueChange:r,...c}=e,s=e.value!=null,a=ve(),d=A(p=>p.search),u=A(p=>p.selectedItemId),b=X();return l.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),l.createElement(E.input,{ref:n,...c,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":b.listId,"aria-labelledby":b.labelId,"aria-activedescendant":u,id:b.inputId,type:"text",value:s?e.value:d,onChange:p=>{s||a.setState("search",p.target.value),r?.(p.target.value)}})}),Yt=l.forwardRef((e,n)=>{let{children:r,label:c="Suggestions",...s}=e,a=l.useRef(null),d=l.useRef(null),u=A(p=>p.selectedItemId),b=X();return l.useEffect(()=>{if(d.current&&a.current){let p=d.current,h=a.current,x,w=new ResizeObserver(()=>{x=requestAnimationFrame(()=>{let N=p.offsetHeight;h.style.setProperty("--cmdk-list-height",N.toFixed(1)+"px")})});return w.observe(p),()=>{cancelAnimationFrame(x),w.unobserve(p)}}},[]),l.createElement(E.div,{ref:G(a,n),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":u,"aria-label":c,id:b.listId},re(e,p=>l.createElement("div",{ref:G(d,b.listInnerRef),"cmdk-list-sizer":""},p)))}),er=l.forwardRef((e,n)=>{let{open:r,onOpenChange:c,overlayClassName:s,contentClassName:a,container:d,...u}=e;return l.createElement(lt,{open:r,onOpenChange:c},l.createElement(it,{container:d},l.createElement(ct,{"cmdk-overlay":"",className:s}),l.createElement(dt,{"aria-label":e.label,"cmdk-dialog":"",className:a},l.createElement(Ge,{ref:n,...u}))))}),tr=l.forwardRef((e,n)=>A(r=>r.filtered.count===0)?l.createElement(E.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),rr=l.forwardRef((e,n)=>{let{progress:r,children:c,label:s="Loading...",...a}=e;return l.createElement(E.div,{ref:n,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},re(e,d=>l.createElement("div",{"aria-hidden":!0},d)))}),te=Object.assign(Ge,{List:Yt,Item:Wt,Input:Qt,Group:Jt,Separator:Zt,Dialog:er,Empty:tr,Loading:rr});function nr(e,n){let r=e.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function ar(e,n){let r=e.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function Xe(e){let n=l.useRef(e);return F(()=>{n.current=e}),n}var F=typeof window>"u"?l.useEffect:l.useLayoutEffect;function z(e){let n=l.useRef();return n.current===void 0&&(n.current=e()),n}function A(e){let n=ve(),r=()=>e(n.snapshot());return l.useSyncExternalStore(n.subscribe,r,r)}function We(e,n,r,c=[]){let s=l.useRef(),a=X();return F(()=>{var d;let u=(()=>{var p;for(let h of r){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(p=h.current.textContent)==null?void 0:p.trim():s.current}})(),b=c.map(p=>p.trim());a.value(e,u,b),(d=n.current)==null||d.setAttribute($,u),s.current=u}),s}var sr=()=>{let[e,n]=l.useState(),r=z(()=>new Map);return F(()=>{r.current.forEach(c=>c()),r.current=new Map},[e]),(c,s)=>{r.current.set(c,s),n({})}};function or(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function re({asChild:e,children:n},r){return e&&l.isValidElement(n)?l.cloneElement(or(n),{ref:n.ref},r(n.props.children)):r(n)}var lr={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function ir({className:e,...n}){return t.jsx(te,{"data-slot":"command",className:ee("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...n})}function cr({className:e,...n}){return t.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[t.jsx(Mt,{className:"size-4 shrink-0 opacity-50"}),t.jsx(te.Input,{"data-slot":"command-input",className:ee("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...n})]})}function dr({...e}){return t.jsx(te.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function ur({className:e,...n}){return t.jsx(te.Item,{"data-slot":"command-item",className:ee("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}var ne="Popover",[Je,_r]=mt(ne,[$e]),W=$e(),[pr,O]=Je(ne),Ze=e=>{const{__scopePopover:n,children:r,open:c,defaultOpen:s,onOpenChange:a,modal:d=!1}=e,u=W(n),b=l.useRef(null),[p,h]=l.useState(!1),[x,w]=ut({prop:c,defaultProp:s??!1,onChange:a,caller:ne});return t.jsx(pt,{...u,children:t.jsx(pr,{scope:n,contentId:M(),triggerRef:b,open:x,onOpenChange:w,onOpenToggle:l.useCallback(()=>w(N=>!N),[w]),hasCustomAnchor:p,onCustomAnchorAdd:l.useCallback(()=>h(!0),[]),onCustomAnchorRemove:l.useCallback(()=>h(!1),[]),modal:d,children:r})})};Ze.displayName=ne;var Qe="PopoverAnchor",mr=l.forwardRef((e,n)=>{const{__scopePopover:r,...c}=e,s=O(Qe,r),a=W(r),{onCustomAnchorAdd:d,onCustomAnchorRemove:u}=s;return l.useEffect(()=>(d(),()=>u()),[d,u]),t.jsx(Le,{...a,...c,ref:n})});mr.displayName=Qe;var Ye="PopoverTrigger",et=l.forwardRef((e,n)=>{const{__scopePopover:r,...c}=e,s=O(Ye,r),a=W(r),d=ze(n,s.triggerRef),u=t.jsx(E.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":st(s.open),...c,ref:d,onClick:U(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?u:t.jsx(Le,{asChild:!0,...a,children:u})});et.displayName=Ye;var he="PopoverPortal",[fr,vr]=Je(he,{forceMount:void 0}),tt=e=>{const{__scopePopover:n,forceMount:r,children:c,container:s}=e,a=O(he,n);return t.jsx(fr,{scope:n,forceMount:r,children:t.jsx(qe,{present:r||a.open,children:t.jsx(ft,{asChild:!0,container:s,children:c})})})};tt.displayName=he;var L="PopoverContent",rt=l.forwardRef((e,n)=>{const r=vr(L,e.__scopePopover),{forceMount:c=r.forceMount,...s}=e,a=O(L,e.__scopePopover);return t.jsx(qe,{present:c||a.open,children:a.modal?t.jsx(xr,{...s,ref:n}):t.jsx(gr,{...s,ref:n})})});rt.displayName=L;var hr=xt("PopoverContent.RemoveScroll"),xr=l.forwardRef((e,n)=>{const r=O(L,e.__scopePopover),c=l.useRef(null),s=ze(n,c),a=l.useRef(!1);return l.useEffect(()=>{const d=c.current;if(d)return vt(d)},[]),t.jsx(ht,{as:hr,allowPinchZoom:!0,children:t.jsx(nt,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:U(e.onCloseAutoFocus,d=>{d.preventDefault(),a.current||r.triggerRef.current?.focus()}),onPointerDownOutside:U(e.onPointerDownOutside,d=>{const u=d.detail.originalEvent,b=u.button===0&&u.ctrlKey===!0,p=u.button===2||b;a.current=p},{checkForDefaultPrevented:!1}),onFocusOutside:U(e.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),gr=l.forwardRef((e,n)=>{const r=O(L,e.__scopePopover),c=l.useRef(!1),s=l.useRef(!1);return t.jsx(nt,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(c.current||r.triggerRef.current?.focus(),a.preventDefault()),c.current=!1,s.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(c.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const d=a.target;r.triggerRef.current?.contains(d)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),nt=l.forwardRef((e,n)=>{const{__scopePopover:r,trapFocus:c,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:d,onEscapeKeyDown:u,onPointerDownOutside:b,onFocusOutside:p,onInteractOutside:h,...x}=e,w=O(L,r),N=W(r);return gt(),t.jsx(bt,{asChild:!0,loop:!0,trapped:c,onMountAutoFocus:s,onUnmountAutoFocus:a,children:t.jsx(yt,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:h,onEscapeKeyDown:u,onPointerDownOutside:b,onFocusOutside:p,onDismiss:()=>w.onOpenChange(!1),children:t.jsx(jt,{"data-state":st(w.open),role:"dialog",id:w.contentId,...N,...x,ref:n,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),at="PopoverClose",br=l.forwardRef((e,n)=>{const{__scopePopover:r,...c}=e,s=O(at,r);return t.jsx(E.button,{type:"button",...c,ref:n,onClick:U(e.onClick,()=>s.onOpenChange(!1))})});br.displayName=at;var yr="PopoverArrow",jr=l.forwardRef((e,n)=>{const{__scopePopover:r,...c}=e,s=W(r);return t.jsx(wt,{...s,...c,ref:n})});jr.displayName=yr;function st(e){return e?"open":"closed"}var wr=Ze,Cr=et,Nr=tt,kr=rt;function Sr({...e}){return t.jsx(wr,{"data-slot":"popover",...e})}function Pr({...e}){return t.jsx(Cr,{"data-slot":"popover-trigger",...e})}function Er({className:e,align:n="center",sideOffset:r=4,...c}){return t.jsx(Nr,{children:t.jsx(kr,{"data-slot":"popover-content",align:n,sideOffset:r,className:ee("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...c})})}function Dr(e){const n=new Set;e.forEach(c=>{c.tasks.forEach(s=>{s.team&&s.team.trim()&&n.add(s.team)})});const r=Array.from(n).sort();return r.length===0?["Dev","QA","Design","PM","UX","UI","Backend","Frontend","Marketing"]:r}function Rr(e){const n=new Set;e.forEach(c=>{c.tasks.forEach(s=>{s.sprint&&s.sprint.trim()&&n.add(s.sprint)})});const r=Array.from(n).sort();return r.length===0?["Sprint 1","Sprint 2","Sprint 3","Sprint 4","Sprint 5","Backlog","Icebox"]:r}function $r({task:e,isOpen:n,onClose:r,onSave:c,milestones:s}){const[a,d]=l.useState({name:"",description:"",team:"",sprint:"",durationDays:1,dependsOn:[]}),[u,b]=l.useState({}),[p,h]=l.useState(!1),x=Ce.useMemo(()=>Dr(s),[s]),w=Ce.useMemo(()=>Rr(s),[s]);l.useEffect(()=>{if(n){if(e)d({name:e.name,description:e.description,team:e.team,sprint:e.sprint||"",durationDays:e.durationDays,dependsOn:e.dependsOn||[]});else{const i=x.length>0?x[0]:"Dev",f=w.length>0?w[0]:"";d({name:"",description:"",team:i,sprint:f,durationDays:1,dependsOn:[]})}b({})}},[e,n,x,w]);const N=()=>{const i={};return a.name.trim()||(i.name="Name is required"),a.team||(i.team="Team is required"),a.durationDays<1&&(i.durationDays="Duration must be at least 1 day"),a.durationDays>365&&(i.durationDays="Duration cannot exceed 365 days"),b(i),Object.keys(i).length===0},P=()=>{if(!N())return;const i={name:a.name.trim(),description:a.description.trim(),team:a.team,sprint:a.sprint==="none"?void 0:a.sprint||void 0,durationDays:a.durationDays,dependsOn:a.dependsOn},f=e?e.taskId:"new-task-placeholder";c(f,i),r()},R=(i,f)=>{d(y=>({...y,[i]:f})),u[i]&&b(y=>({...y,[i]:""}))},D=i=>{const f=i.target.value;if(f==="")R("durationDays",1);else{const y=parseInt(f);!isNaN(y)&&y>=1&&y<=365&&R("durationDays",y)}},I=s.flatMap(i=>i.tasks.filter(f=>f.taskId!==e?.taskId)),q=i=>{a.dependsOn.includes(i)||d(f=>({...f,dependsOn:[...f.dependsOn,i]})),h(!1)},J=i=>{d(f=>({...f,dependsOn:f.dependsOn.filter(y=>y!==i)}))},V=i=>{for(const f of s){const y=f.tasks.find(K=>K.taskId===i);if(y)return{task:y,milestone:f.milestoneName}}return null};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
        .task-edit-modal {
          width: 60vw !important;
          max-width: 60vw !important;
          min-width: 60vw !important;
        }
        .task-edit-modal[data-slot="dialog-content"] {
          width: 60vw !important;
          max-width: 60vw !important;
        }
        /* Fix z-index for dropdowns inside modal */
        .task-edit-modal [data-radix-popper-content-wrapper] {
          z-index: 10000 !important;
        }
        .task-edit-modal [data-radix-select-content] {
          z-index: 10002 !important;
        }
        .task-edit-modal [data-radix-popover-content] {
          z-index: 10001 !important;
        }
      `}),t.jsx(Ct,{open:n,onOpenChange:r,children:t.jsxs(Nt,{className:"max-h-[90vh] task-edit-modal",style:{zIndex:9999},children:[t.jsxs(kt,{children:[t.jsxs(St,{className:"flex items-center gap-2",children:[t.jsx(Ne,{className:"w-5 h-5"}),e?"Edit Task":"Create New Task"]}),t.jsx(Pt,{children:e?"Modify task details, assign teams, set duration, and manage dependencies.":"Create a new task with details, team assignment, duration, and dependencies."})]}),t.jsx("div",{className:"max-h-[70vh] overflow-y-auto pr-2",children:t.jsxs("div",{className:"space-y-4",children:[e&&e.startDate&&e.endDate&&t.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Ne,{className:"w-4 h-4"}),"Project dates"]}),t.jsxs("div",{className:"text-sm",children:[ke(Pe(e.startDate),"dd/MM/yyyy",{locale:Se})," ","-"," ",ke(Pe(e.endDate),"dd/MM/yyyy",{locale:Se})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(_,{htmlFor:"taskName",children:"Task name *"}),t.jsx(Ee,{id:"taskName",value:a.name,onChange:i=>R("name",i.target.value),placeholder:"E.g.: Create initial wireframes",className:u.name?"border-destructive":""}),u.name&&t.jsx("p",{className:"text-sm text-destructive",children:u.name})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(_,{htmlFor:"taskDescription",children:"Description"}),t.jsx(Ot,{id:"taskDescription",value:a.description,onChange:i=>d({...a,description:i.target.value}),placeholder:"Detailed task description...",className:"min-h-[100px]"})]}),t.jsxs("div",{className:"flex flex-row gap-4 items-start",children:[t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsx(_,{children:"Assigned team *"}),t.jsxs(Ie,{value:a.team,onValueChange:i=>d({...a,team:i}),children:[t.jsx(Ae,{className:u.team?"border-red-500":"",children:t.jsx(Oe,{placeholder:"Select team"})}),t.jsx(Me,{style:{zIndex:1e4},children:x.map(i=>t.jsx(ce,{value:i,children:i},i))})]}),u.team&&t.jsx("p",{className:"text-sm text-destructive",children:u.team})]}),t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsxs(_,{className:"flex items-center gap-2",children:[t.jsx(De,{className:"w-4 h-4"}),"Assigned sprint"]}),t.jsxs(Ie,{value:a.sprint,onValueChange:i=>R("sprint",i),children:[t.jsx(Ae,{children:t.jsx(Oe,{placeholder:"Select sprint (optional)"})}),t.jsxs(Me,{style:{zIndex:1e4},children:[t.jsx(ce,{value:"none",children:"No sprint assigned"}),w.map(i=>t.jsx(ce,{value:i,children:i},i))]})]})]}),t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsxs(_,{htmlFor:"duration",className:"flex items-center gap-2",children:[t.jsx(Et,{className:"w-4 h-4"}),"Duration in working days *"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ee,{id:"duration",type:"number",min:"1",max:"365",value:a.durationDays,onChange:D,className:`w-24 ${u.durationDays?"border-destructive":""}`}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"days"})]}),u.durationDays&&t.jsx("p",{className:"text-sm text-destructive",children:u.durationDays})]})]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Excludes weekends from calculation"}),t.jsx("hr",{className:"my-6 border-muted"}),t.jsxs("div",{className:"space-y-3 border-2 border-blue-200 rounded-lg p-4 bg-blue-50/30",children:[t.jsxs(_,{className:"flex items-center gap-2 text-base font-semibold",children:[t.jsx(_t,{className:"w-5 h-5 text-blue-600"}),"Task Dependencies"]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Select tasks that must be completed before this task can start"}),a.dependsOn.length>0&&t.jsx("div",{className:"space-y-1 mb-3",children:a.dependsOn.map(i=>{const f=V(i);return f?t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium",children:f.task.name}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[f.milestone," • ",f.task.team]})]}),t.jsx(Q,{type:"button",variant:"ghost",size:"sm",onClick:()=>J(i),className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",children:t.jsx(Dt,{className:"w-3 h-3"})})]},i):null})}),I.length>0?t.jsxs(Sr,{open:p,onOpenChange:h,children:[t.jsx(Pr,{asChild:!0,children:t.jsxs(Q,{variant:"outline",role:"combobox","aria-expanded":p,className:"w-full justify-between h-10 font-normal text-sm",children:["Add task dependency... (",I.length," ","available)",t.jsx(Rt,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),t.jsx(Er,{className:"w-full p-0",style:{zIndex:10001,maxHeight:"400px"},children:t.jsxs(ir,{children:[t.jsx(cr,{placeholder:"Search tasks...",className:"h-9"}),t.jsx(dr,{className:"py-6 text-center text-sm",children:"No tasks found."}),t.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:I.filter(i=>!a.dependsOn.includes(i.taskId)).map(i=>t.jsx(ur,{value:`${i.name} ${i.taskId} ${i.team}`,onSelect:()=>q(i.taskId),className:"cursor-pointer",children:t.jsxs("div",{className:"flex items-center justify-between w-full gap-2",children:[t.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium truncate text-sm",children:i.name}),t.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",i.team,")"]})]}),t.jsx("span",{className:"text-xs text-muted-foreground font-mono whitespace-nowrap",children:i.taskId})]})},i.taskId))})]})})]}):t.jsx("div",{className:"p-3 text-center text-sm text-muted-foreground border border-dashed rounded-lg",children:"No other tasks available for dependencies"})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(It,{className:"w-4 h-4 text-muted-foreground"}),t.jsx(Re,{variant:"outline",style:{borderColor:Y[a.team]||Y.Default,color:Y[a.team]||Y.Default},children:a.team||"No team"})]}),a.sprint&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(De,{className:"w-4 h-4 text-muted-foreground"}),t.jsx(Re,{variant:"secondary",children:a.sprint})]})]})]})}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsxs(Q,{onClick:P,className:"flex-1 flex items-center gap-2",children:[t.jsx(Ft,{className:"w-4 h-4"}),e?"Save changes":"Create task"]}),t.jsxs(Q,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[t.jsx(At,{className:"w-4 h-4"}),"Cancel"]})]})]})})]})}export{$r as TaskEditModal};
