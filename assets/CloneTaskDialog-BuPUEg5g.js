import{r as l,j as e,H as G,al as X,M as I,G as $,a7 as _,N as E,aD as K,a4 as U,D as V,p as J,q as Q,s as W,w as T,u as Y,L as w,I as Z,v as ee,B as R,X as se}from"./index-CfEYXZBA.js";import{u as te,C as ne,S as ae,a as re,b as ce,c as oe,d as ie}from"./select-BNkLsDEQ.js";import{C as le}from"./circle-check-big-wQvsvjyk.js";import{C as de}from"./circle-alert-DUfNsyZ5.js";var v="Checkbox",[ue,ke]=G(v),[me,D]=ue(v);function he(t){const{__scopeCheckbox:c,checked:d,children:n,defaultChecked:o,disabled:s,form:r,name:u,onCheckedChange:i,required:b,value:C="on",internal_do_not_use_render:x}=t,[f,a]=$({prop:d,defaultProp:o??!1,onChange:i,caller:v}),[m,k]=l.useState(null),[j,h]=l.useState(null),p=l.useRef(!1),N=m?!!r||!!m.closest("form"):!0,y={checked:f,disabled:s,setChecked:a,control:m,setControl:k,name:u,form:r,value:C,hasConsumerStoppedPropagationRef:p,required:b,defaultChecked:g(o)?!1:o,isFormControl:N,bubbleInput:j,setBubbleInput:h};return e.jsx(me,{scope:c,...y,children:xe(x)?x(y):n})}var P="CheckboxTrigger",M=l.forwardRef(({__scopeCheckbox:t,onKeyDown:c,onClick:d,...n},o)=>{const{control:s,value:r,disabled:u,checked:i,required:b,setControl:C,setChecked:x,hasConsumerStoppedPropagationRef:f,isFormControl:a,bubbleInput:m}=D(P,t),k=_(o,C),j=l.useRef(i);return l.useEffect(()=>{const h=s?.form;if(h){const p=()=>x(j.current);return h.addEventListener("reset",p),()=>h.removeEventListener("reset",p)}},[s,x]),e.jsx(I.button,{type:"button",role:"checkbox","aria-checked":g(i)?"mixed":i,"aria-required":b,"data-state":A(i),"data-disabled":u?"":void 0,disabled:u,value:r,...n,ref:k,onKeyDown:E(c,h=>{h.key==="Enter"&&h.preventDefault()}),onClick:E(d,h=>{x(p=>g(p)?!0:!p),m&&a&&(f.current=h.isPropagationStopped(),f.current||h.stopPropagation())})})});M.displayName=P;var B=l.forwardRef((t,c)=>{const{__scopeCheckbox:d,name:n,checked:o,defaultChecked:s,required:r,disabled:u,value:i,onCheckedChange:b,form:C,...x}=t;return e.jsx(he,{__scopeCheckbox:d,checked:o,defaultChecked:s,disabled:u,required:r,onCheckedChange:b,name:n,form:C,value:i,internal_do_not_use_render:({isFormControl:f})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...x,ref:c,__scopeCheckbox:d}),f&&e.jsx(q,{__scopeCheckbox:d})]})})});B.displayName=v;var F="CheckboxIndicator",L=l.forwardRef((t,c)=>{const{__scopeCheckbox:d,forceMount:n,...o}=t,s=D(F,d);return e.jsx(X,{present:n||g(s.checked)||s.checked===!0,children:e.jsx(I.span,{"data-state":A(s.checked),"data-disabled":s.disabled?"":void 0,...o,ref:c,style:{pointerEvents:"none",...t.style}})})});L.displayName=F;var O="CheckboxBubbleInput",q=l.forwardRef(({__scopeCheckbox:t,...c},d)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:s,defaultChecked:r,required:u,disabled:i,name:b,value:C,form:x,bubbleInput:f,setBubbleInput:a}=D(O,t),m=_(d,a),k=te(s),j=K(n);l.useEffect(()=>{const p=f;if(!p)return;const N=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(N,"checked").set,z=!o.current;if(k!==s&&S){const H=new Event("click",{bubbles:z});p.indeterminate=g(s),S.call(p,g(s)?!1:s),p.dispatchEvent(H)}},[f,k,s,o]);const h=l.useRef(g(s)?!1:s);return e.jsx(I.input,{type:"checkbox","aria-hidden":!0,defaultChecked:r??h.current,required:u,disabled:i,name:b,value:C,form:x,...c,tabIndex:-1,ref:m,style:{...c.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});q.displayName=O;function xe(t){return typeof t=="function"}function g(t){return t==="indeterminate"}function A(t){return g(t)?"indeterminate":t?"checked":"unchecked"}function pe({className:t,...c}){return e.jsx(B,{"data-slot":"checkbox",className:U("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...c,children:e.jsx(L,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ne,{className:"size-3.5"})})})}function je({isOpen:t,onClose:c,onConfirm:d,task:n,milestones:o,currentMilestoneId:s}){const[r,u]=l.useState({targetMilestoneId:s,includeDependencies:!0,newTaskName:""}),[i,b]=l.useState(!1);if(l.useEffect(()=>{n&&t&&u({targetMilestoneId:s,includeDependencies:!0,newTaskName:`${n.name} (Copy)`})},[n,t,s]),!n)return null;const C=async()=>{b(!0);try{await d(r),c()}catch(a){console.error("Failed to clone task:",a)}finally{b(!1)}},x=o.find(a=>a.milestoneId===r.targetMilestoneId),f=r.targetMilestoneId===s;return e.jsx(V,{open:t,onOpenChange:c,children:e.jsxs(J,{className:"max-w-md",children:[e.jsxs(Q,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-blue-600"}),"Clone Task"]}),e.jsxs(Y,{children:['Create a copy of "',n.name,'" with customizable options.']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"taskName",children:"New task name"}),e.jsx(Z,{id:"taskName",value:r.newTaskName,onChange:a=>u(m=>({...m,newTaskName:a.target.value})),placeholder:"Enter name for cloned task"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Target milestone"}),e.jsxs(ae,{value:r.targetMilestoneId,onValueChange:a=>u(m=>({...m,targetMilestoneId:a})),children:[e.jsx(re,{children:e.jsx(ce,{placeholder:"Select milestone"})}),e.jsx(oe,{children:o.map(a=>e.jsx(ie,{value:a.milestoneId,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:a.milestoneName}),a.milestoneId===s&&e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:"(current)"})]})},a.milestoneId))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{id:"includeDependencies",checked:r.includeDependencies,onCheckedChange:a=>u(m=>({...m,includeDependencies:a===!0}))}),e.jsxs(w,{htmlFor:"includeDependencies",className:"flex items-center gap-2",children:["Include dependencies",e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n.dependsOn.length," dependencies)"]})]})]}),e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Clone Summary:"}),e.jsxs("ul",{className:"text-muted-foreground mt-1 space-y-1",children:[e.jsxs("li",{children:['• Task: "',r.newTaskName||n.name,'"']}),e.jsxs("li",{children:["• Milestone: ",x?.milestoneName]}),e.jsxs("li",{children:["• Duration: ",n.durationDays," days"]}),e.jsxs("li",{children:["• Team: ",n.team]}),e.jsxs("li",{children:["• Dependencies:"," ",r.includeDependencies?`${n.dependsOn.length} included`:"None (excluded)"]})]})]})]})}),!f&&e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("div",{className:"font-medium",children:"Cross-milestone clone"}),e.jsx("div",{className:"mt-1",children:"Cloning to a different milestone may affect dependency relationships. Timeline will be recalculated after cloning."})]})]})})]}),e.jsxs(ee,{children:[e.jsxs(R,{variant:"outline",onClick:c,disabled:i,children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(R,{onClick:C,disabled:i||!r.newTaskName.trim(),className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),i?"Cloning...":"Clone Task"]})]})]})})}export{je as CloneTaskDialog};
