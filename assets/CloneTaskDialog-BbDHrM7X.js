import{r as o,j as e,D as C,a as w,b as y,d as v,w as p,e as D,L as m,I as b,f as T,B as j,X as k}from"./index-J8Qw_ett.js";import{C as I}from"./checkbox-DZ17iQRE.js";import{S,a as M,b as E,c as F,d as L}from"./select-CH4IpKw2.js";import{C as B}from"./circle-check-big-Bhjb3c77.js";import{C as O}from"./circle-alert-C5zpbaah.js";import"./index-C0xwkFqE.js";function X({isOpen:c,onClose:d,onConfirm:u,task:a,milestones:x,currentMilestoneId:n}){const[l,t]=o.useState({targetMilestoneId:n,includeDependencies:!0,newTaskName:""}),[r,h]=o.useState(!1);if(o.useEffect(()=>{a&&c&&t({targetMilestoneId:n,includeDependencies:!0,newTaskName:`${a.name} (Copy)`})},[a,c,n]),!a)return null;const g=async()=>{h(!0);try{await u(l),d()}catch(s){console.error("Failed to clone task:",s)}finally{h(!1)}},N=x.find(s=>s.milestoneId===l.targetMilestoneId),f=l.targetMilestoneId===n;return e.jsx(C,{open:c,onOpenChange:d,children:e.jsxs(w,{className:"max-w-md",children:[e.jsxs(y,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-blue-600"}),"Clone Task"]}),e.jsxs(D,{children:['Create a copy of "',a.name,'" with customizable options.']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"taskName",children:"New task name"}),e.jsx(b,{id:"taskName",value:l.newTaskName,onChange:s=>t(i=>({...i,newTaskName:s.target.value})),placeholder:"Enter name for cloned task"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Target milestone"}),e.jsxs(S,{value:l.targetMilestoneId,onValueChange:s=>t(i=>({...i,targetMilestoneId:s})),children:[e.jsx(M,{children:e.jsx(E,{placeholder:"Select milestone"})}),e.jsx(F,{children:x.map(s=>e.jsx(L,{value:s.milestoneId,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:s.milestoneName}),s.milestoneId===n&&e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:"(current)"})]})},s.milestoneId))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{id:"includeDependencies",checked:l.includeDependencies,onCheckedChange:s=>t(i=>({...i,includeDependencies:s===!0}))}),e.jsxs(m,{htmlFor:"includeDependencies",className:"flex items-center gap-2",children:["Include dependencies",e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.dependsOn.length," dependencies)"]})]})]}),e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Clone Summary:"}),e.jsxs("ul",{className:"text-muted-foreground mt-1 space-y-1",children:[e.jsxs("li",{children:['• Task: "',l.newTaskName||a.name,'"']}),e.jsxs("li",{children:["• Milestone: ",N?.milestoneName]}),e.jsxs("li",{children:["• Duration: ",a.durationDays," days"]}),e.jsxs("li",{children:["• Team: ",a.team]}),e.jsxs("li",{children:["• Dependencies:"," ",l.includeDependencies?`${a.dependsOn.length} included`:"None (excluded)"]})]})]})]})}),!f&&e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("div",{className:"font-medium",children:"Cross-milestone clone"}),e.jsx("div",{className:"mt-1",children:"Cloning to a different milestone may affect dependency relationships. Timeline will be recalculated after cloning."})]})]})})]}),e.jsxs(T,{children:[e.jsxs(j,{variant:"outline",onClick:d,disabled:r,children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(j,{onClick:g,disabled:r||!l.newTaskName.trim(),className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-4 h-4"}),r?"Cloning...":"Clone Task"]})]})]})})}export{X as CloneTaskDialog};
